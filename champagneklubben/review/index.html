<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Champagne Tasting Club</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header>
        <h1>Champagne Tasting Club</h1>
        <p>Welcome to our club! Please share your champagne tasting experiences below.</p>
    </header>

    <main>
        <form id="champagneForm">
            <label for="name">Champagne Name:</label>
            <input type="text" id="name" name="name" required>

            <label for="brand">Brand:</label>
            <input type="text" id="brand" name="brand" required>

            <label for="vintage">Vintage:</label>
            <input type="number" id="vintage" name="vintage" required>
            <label for="rating">Rating (1-10):</label>
            <input type="number" id="rating" name="rating" min="1" max="10" required>

            <label for="tastingNotes">Tasting Notes:</label>
            <textarea id="tastingNotes" name="tastingNotes" required></textarea>

            <button type="submit">Submit</button>
        </form>

        <div id="champagneList">
            <!-- The list of champagnes will be dynamically added here using JavaScript -->
        </div>
    </main>

    <!-- Add this just before the closing </body> tag -->

    <!-- <script src="https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.6/firebase-database.js"></script> -->
    <script src="https://www.gstatic.com/firebasejs/9.6.6/firebase-compat.js"></script>

    <script src="champagne_form.js"></script>



    <script>

// Initialize Firebase with your own config
const firebaseConfig = {
  apiKey: "AIzaSyAr877VPCvgyQ3Jdvlw4pcAR4-auvINSTs",
  authDomain: "champagneklubben-7a08f.firebaseapp.com",
  databaseURL: "https://champagneklubben-7a08f-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "champagneklubben-7a08f",
  storageBucket: "champagneklubben-7a08f.appspot.com",
  messagingSenderId: "6468099736",
  appId: "1:6468099736:web:13077310fed28854bf7aed",
  measurementId: "G-0YHBH7C18G"
};
  firebase.initializeApp(firebaseConfig);
</script>

<!-- Add this just before the closing </body> tag, after the Firebase initialization -->
<script>
    const form = document.getElementById("champagneForm");
    const database = firebase.database();
    let user = null;
  
    // Function to check if the user is authenticated
    firebase.auth().onAuthStateChanged((currentUser) => {
      user = currentUser;
      if (user) {
        // User is authenticated, enable form submission
        form.addEventListener("submit", handleSubmitForm);
      } else {
        // User is not authenticated, disable form submission
        form.removeEventListener("submit", handleSubmitForm);
      }
    });
  
    // Function to handle form submission
    function handleSubmitForm(e) {
      e.preventDefault();
  
      // Get form data
      const name = document.getElementById("name").value;
      const brand = document.getElementById("brand").value;
      const vintage = document.getElementById("vintage").value;
      const rating = document.getElementById("rating").value;
      const tastingNotes = document.getElementById("tastingNotes").value;
  
      // Store the data in Firebase
      const champagneRef = database.ref("champagnes");
      const newChampagneRef = champagneRef.push();
      newChampagneRef.set({
        name,
        brand,
        vintage,
        rating,
        tastingNotes,
      });
  
      // Reset the form after submission
      form.reset();
    }
  </script>
  
  

<!-- Add this just before the closing </body> tag, after the Firebase initialization and form handling -->
<script>
    const champagneList = document.getElementById("champagneList");
  
    // Function to fetch and display champagnes from Firebase
    function displayChampagnes() {
      const champagneRef = database.ref("champagnes");
  
      champagneRef.on("value", (snapshot) => {
        champagneList.innerHTML = "";
        snapshot.forEach((childSnapshot) => {
          const { name, brand, vintage, rating, tastingNotes } = childSnapshot.val();
          const listItem = document.createElement("li");
          listItem.innerHTML = `<strong>${name}</strong> (${brand}, ${vintage}) - Rating: ${rating}/10<br>${tastingNotes}`;
          champagneList.appendChild(listItem);
        });
      });
    }
  
    // Call the function to display the stored champagnes on page load
    displayChampagnes();
  </script>
  

</body>
</html>
